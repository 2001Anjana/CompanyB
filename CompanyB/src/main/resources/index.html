<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Finance System Test Interface</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
</head>
<body>
<h1>Finance System Testing Interface</h1>

<!-- Form to simulate receiving a shortage report from the Sales System -->
<h2>Simulate Inventory Shortage Report</h2>
<form id="shortageReportForm">
    <input type="text" id="materialId" placeholder="Material ID" required>
    <input type="text" id="materialName" placeholder="Material Name" required>
    <input type="number" id="quantityShort" placeholder="Quantity Short" required>
    <input type="number" id="perUnitPrice" placeholder="Per Unit Price" required>
    <button type="submit">Submit Shortage Report</button>
</form>

<!-- Display Area for Invoice Generated from Shortage Report -->
<div id="invoiceDisplay"></div>

<!-- Form to Get All Invoices -->
<h2>Fetch All Invoices</h2>
<button onclick="fetchAllInvoices()">Get All Invoices</button>
<div id="invoicesDisplay"></div>

<script>
    // Handle the shortage report form submission
    $('#shortageReportForm').submit(function(e) {
        e.preventDefault();
        var shortageData = {
            materialId: $('#materialId').val(),
            materialName: $('#materialName').val(),
            quantityShort: parseInt($('#quantityShort').val()),
            perUnitPrice: parseFloat($('#perUnitPrice').val())
        };
        $.ajax({
            url: 'http://localhost:8080/api/finance/shortageReports',  // Adjust this URL to your API endpoint
            type: 'POST',
            contentType: 'application/json',
            data: JSON.stringify(shortageData),
            success: function(data) {
                var display = '<h3>Generated Invoice:</h3>' +
                    '<p>Material Name: ' + data.materialName + ', ' +
                    'Quantity Short: ' + data.quantityShort + ', ' +
                    'Market Price: ' + data.marketPrice.toFixed(2) + ', ' +
                    'Potential Loss: $' + data.potentialLoss.toFixed(2) + '</p>';
                $('#invoiceDisplay').html(display);
            },
            error: function() {
                alert('Error processing shortage report.');
            }
        });
    });

    // Function to fetch all invoices
    function fetchAllInvoices() {
        $.ajax({
            url: 'http://localhost:8080/api/finance/invoices',
            type: 'GET',
            success: function(data) {
                var display = '<h3>Invoices:</h3>';
                data.forEach(function(invoice) {
                    display += '<p>Material Name: ' + invoice.materialName + ', ' +
                        'Quantity Short: ' + invoice.quantityShort + ', ' +
                        'Potential Loss: $' + invoice.potentialLoss.toFixed(2) + '</p>';
                });
                $('#invoicesDisplay').html(display);
            },
            error: function() {
                alert('Error fetching invoices.');
            }
        });
    }
</script>
</body>
</html>
